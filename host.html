<html>
<head><title>Host presentation</title>
<link rel="stylesheet" href="/static/css/style.css"/>
<script src="/static/js/jquery-1.7.1.min.js"></script>
<script src="/static/js/socket.io.js"></script>
<script>

var PR = PR || {
    socket: null,
    likes: 0,
    data: {
        slide_number: null,
        slide_header: null
    }
};

function join() {
    $("#join_button_loader").show();
    
    PR.socket = io.connect('http://localhost:8888?host=ron');

    /* TODO What if I couldn't connect? */
    PR.socket.on("like", addLike);

    $("#connected_div").show();
    $("#join_button").hide();
    $("#join_button_loader").hide();
}

function addLike(slide_number) {
    s = slide_number;
    if (slide_number == PR.data.slide_number) {
        PR.likes = PR.likes + 1;
        reloadSlide()
    }
}

function nextSlide() {
    if (PR.data == null || PR.data.slide_number == null) {
        PR.data = {"slide_number" : 1, "slide_header" : "1 slide"};
    } else {
        var new_slide_number = PR.data.slide_number + 1;
        PR.data = {"slide_number" : new_slide_number, "slide_header" : new_slide_number + " slide"}
    }
    reloadSlide();

    PR.socket.emit("slide_transfer", PR.data);
}

function reloadSlide() {
    $(".slide_number").text(PR.data.slide_number);
    $(".slide_header").text(PR.data.slide_header);
    $("#likes").text(PR.likes + " Likes");
}

$(function() {
    join();
})
</script>
</head>
<body>
<div id="likes">0 Likes</div>
<div class="slide">
    <div class="slide_number"></div>
    <div class="slide_header"></div>
</div>
<div id="nextSlide" class="button" onclick="nextSlide()">
    Next slide
</div>
</body>
</html>
